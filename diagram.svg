<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 916.63671875 947" style="max-width: 916.63671875px;" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg-1771109119959-onxtrx93y"><style>#mermaid-svg-1771109119959-onxtrx93y{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .error-icon{fill:#141414;}#mermaid-svg-1771109119959-onxtrx93y .error-text{fill:#e34671;stroke:#e34671;}#mermaid-svg-1771109119959-onxtrx93y .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-1771109119959-onxtrx93y .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-1771109119959-onxtrx93y .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-1771109119959-onxtrx93y .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-1771109119959-onxtrx93y .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-1771109119959-onxtrx93y .marker{fill:rgba(228, 228, 228, 0.92);stroke:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .marker.cross{stroke:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-1771109119959-onxtrx93y .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .cluster-label text{fill:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .cluster-label span,#mermaid-svg-1771109119959-onxtrx93y p{color:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .label text,#mermaid-svg-1771109119959-onxtrx93y span,#mermaid-svg-1771109119959-onxtrx93y p{fill:rgba(228, 228, 228, 0.92);color:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .node rect,#mermaid-svg-1771109119959-onxtrx93y .node circle,#mermaid-svg-1771109119959-onxtrx93y .node ellipse,#mermaid-svg-1771109119959-onxtrx93y .node polygon,#mermaid-svg-1771109119959-onxtrx93y .node path{fill:#181818;stroke:#454545;stroke-width:1px;}#mermaid-svg-1771109119959-onxtrx93y .flowchart-label text{text-anchor:middle;}#mermaid-svg-1771109119959-onxtrx93y .node .label{text-align:center;}#mermaid-svg-1771109119959-onxtrx93y .node.clickable{cursor:pointer;}#mermaid-svg-1771109119959-onxtrx93y .arrowheadPath{fill:#e7e7e7;}#mermaid-svg-1771109119959-onxtrx93y .edgePath .path{stroke:rgba(228, 228, 228, 0.92);stroke-width:2.0px;}#mermaid-svg-1771109119959-onxtrx93y .flowchart-link{stroke:rgba(228, 228, 228, 0.92);fill:none;}#mermaid-svg-1771109119959-onxtrx93y .edgeLabel{background-color:#18181899;text-align:center;}#mermaid-svg-1771109119959-onxtrx93y .edgeLabel rect{opacity:0.5;background-color:#18181899;fill:#18181899;}#mermaid-svg-1771109119959-onxtrx93y .labelBkg{background-color:rgba(24, 24, 24, 0.5);}#mermaid-svg-1771109119959-onxtrx93y .cluster rect{fill:rgba(64, 64, 64, 0.47);stroke:#454545;stroke-width:1px;}#mermaid-svg-1771109119959-onxtrx93y .cluster text{fill:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y .cluster span,#mermaid-svg-1771109119959-onxtrx93y p{color:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:rgba(64, 64, 64, 0.6);border:1px solid #454545;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-1771109119959-onxtrx93y .flowchartTitleText{text-anchor:middle;font-size:18px;fill:rgba(228, 228, 228, 0.92);}#mermaid-svg-1771109119959-onxtrx93y :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="6" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="mermaid-svg-1771109119959-onxtrx93y_flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M684.59,34L684.59,38.167C684.59,42.333,684.59,50.667,684.59,58.117C684.59,65.567,684.59,72.133,684.59,75.417L684.59,78.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M684.59,118L684.59,122.167C684.59,126.333,684.59,134.667,684.59,142.117C684.59,149.567,684.59,156.133,684.59,159.417L684.59,162.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M684.59,202L684.59,206.167C684.59,210.333,684.59,218.667,684.59,226.117C684.59,233.567,684.59,240.133,684.59,243.417L684.59,246.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" id="L-D-E-0" d="M641.067,286L626.346,291.75C611.626,297.5,582.184,309,567.463,319.617C552.742,330.233,552.742,339.967,552.742,344.833L552.742,349.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F" id="L-D-F-0" d="M728.112,286L742.833,291.75C757.554,297.5,786.996,309,801.717,319.617C816.438,330.233,816.438,339.967,816.438,344.833L816.438,349.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-G" id="L-E-G-0" d="M552.742,389L552.742,393.167C552.742,397.333,552.742,405.667,552.742,413.117C552.742,420.567,552.742,427.133,552.742,430.417L552.742,433.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" id="L-G-H-0" d="M552.742,473L552.742,477.167C552.742,481.333,552.742,489.667,552.742,497.117C552.742,504.567,552.742,511.133,552.742,514.417L552.742,517.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" id="L-H-I-0" d="M459.655,557L428.169,562.75C396.684,568.5,333.713,580,302.228,590.617C270.742,601.233,270.742,610.967,270.742,615.833L270.742,620.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-J" id="L-H-J-0" d="M552.742,557L552.742,562.75C552.742,568.5,552.742,580,552.742,590.617C552.742,601.233,552.742,610.967,552.742,615.833L552.742,620.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-K" id="L-H-K-0" d="M623.708,557L647.711,562.75C671.714,568.5,719.72,580,743.723,590.617C767.727,601.233,767.727,610.967,767.727,615.833L767.727,620.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-L" id="L-I-L-0" d="M270.742,660L270.742,664.167C270.742,668.333,270.742,676.667,270.742,684.117C270.742,691.567,270.742,698.133,270.742,701.417L270.742,704.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-M" id="L-L-M-0" d="M270.742,744L270.742,748.167C270.742,752.333,270.742,760.667,270.742,768.117C270.742,775.567,270.742,782.133,270.742,785.417L270.742,788.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-N" id="L-M-N-0" d="M224.028,828L208.228,833.75C192.428,839.5,160.827,851,145.027,861.617C129.227,872.233,129.227,881.967,129.227,886.833L129.227,891.7"/><path marker-end="url(#mermaid-svg-1771109119959-onxtrx93y_flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-O" id="L-M-O-0" d="M317.456,828L333.256,833.75C349.057,839.5,380.657,851,396.458,861.617C412.258,872.233,412.258,881.967,412.258,886.833L412.258,891.7"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g transform="translate(552.7421875, 320.5)" class="edgeLabel"><g transform="translate(-52.59765625, -9.5)" class="label"><rect height="19.000314712524414" width="105.1368408203125" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">intercept=true</tspan></text></g></g><g transform="translate(816.4375, 320.5)" class="edgeLabel"><g transform="translate(-54.703125, -9.5)" class="label"><rect height="19.000314712524414" width="109.3451919555664" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">intercept=false</tspan></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g transform="translate(270.7421875, 591.5)" class="edgeLabel"><g transform="translate(-37.76953125, -9.5)" class="label"><rect height="19.000314712524414" width="75.49864196777344" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">drop=false</tspan></text></g></g><g transform="translate(552.7421875, 591.5)" class="edgeLabel"><g transform="translate(-51.72265625, -9.5)" class="label"><rect height="19.000314712524414" width="103.3879165649414" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">drop=true TCP</tspan></text></g></g><g transform="translate(767.7265625, 591.5)" class="edgeLabel"><g transform="translate(-52.53125, -9.5)" class="label"><rect height="19.000314712524414" width="105.00411987304688" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">drop=true UDP</tspan></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><rect height="0" width="0" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve"/></text></g></g><g transform="translate(129.2265625, 862.5)" class="edgeLabel"><g transform="translate(-68.1171875, -9.5)" class="label"><rect height="19.000314712524414" width="136.15850830078125" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">dst port 53 or 5353</tspan></text></g></g><g transform="translate(412.2578125, 862.5)" class="edgeLabel"><g transform="translate(-65.421875, -9.5)" class="label"><rect height="19.000314712524414" width="130.7683868408203" ry="0" rx="0"/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">other destinations</tspan></text></g></g></g><g class="nodes"><g transform="translate(684.58984375, 17)" id="flowchart-A-26" class="node default default flowchart-label"><rect height="34" width="379.0703125" y="-17" x="-189.53515625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Process opens socket (e.g. powershell/pwsh + irm)</tspan></text></g></g><g transform="translate(684.58984375, 101)" id="flowchart-B-27" class="node default default flowchart-label"><rect height="34" width="422.015625" y="-17" x="-211.0078125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Windows redirector (WinDivert socket + network events)</tspan></text></g></g><g transform="translate(684.58984375, 185)" id="flowchart-C-29" class="node default default flowchart-label"><rect height="34" width="223.25" y="-17" x="-111.625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Resolve PID and process path</tspan></text></g></g><g transform="translate(684.58984375, 269)" id="flowchart-D-31" class="node default default flowchart-label"><rect height="34" width="398.7265625" y="-17" x="-199.36328125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Apply InterceptConf actions + forced !mitmproxy_pid</tspan></text></g></g><g transform="translate(552.7421875, 372)" id="flowchart-E-33" class="node default default flowchart-label"><rect height="34" width="258.9921875" y="-17" x="-129.49609375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Send packet + TunnelInfo over IPC</tspan></text></g></g><g transform="translate(816.4375, 372)" id="flowchart-F-35" class="node default default flowchart-label"><rect height="34" width="168.3984375" y="-17" x="-84.19921875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Pass-through reinject</tspan></text></g></g><g transform="translate(552.7421875, 456)" id="flowchart-G-37" class="node default default flowchart-label"><rect height="34" width="470.3125" y="-17" x="-235.15625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">mitmproxy-rs packet source updates global InterceptConf state</tspan></text></g></g><g transform="translate(552.7421875, 540)" id="flowchart-H-39" class="node default default flowchart-label"><rect height="34" width="421.4296875" y="-17" x="-210.71484375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Network filter re-check: should_drop(pid, process, conf)</tspan></text></g></g><g transform="translate(270.7421875, 643)" id="flowchart-I-41" class="node default default flowchart-label"><rect height="34" width="351.0703125" y="-17" x="-175.53515625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Normal TCP/UDP handling to mitmproxy layers</tspan></text></g></g><g transform="translate(552.7421875, 643)" id="flowchart-J-43" class="node default default flowchart-label"><rect height="34" width="112.9296875" y="-17" x="-56.46484375" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Send TCP RST</tspan></text></g></g><g transform="translate(767.7265625, 643)" id="flowchart-K-45" class="node default default flowchart-label"><rect height="34" width="217.0390625" y="-17" x="-108.51953125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">Send ICMP Port Unreachable</tspan></text></g></g><g transform="translate(270.7421875, 727)" id="flowchart-L-47" class="node default default flowchart-label"><rect height="34" width="264.2265625" y="-17" x="-132.11328125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">mitmproxy local transparent mode</tspan></text></g></g><g transform="translate(270.7421875, 811)" id="flowchart-M-49" class="node default default flowchart-label"><rect height="34" width="203.890625" y="-17" x="-101.9453125" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">NextLayer protocol choice</tspan></text></g></g><g transform="translate(129.2265625, 914)" id="flowchart-N-51" class="node default default flowchart-label"><rect height="34" width="258.453125" y="-17" x="-129.2265625" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">DNSLayer handles query/response</tspan></text></g></g><g transform="translate(412.2578125, 914)" id="flowchart-O-53" class="node default default flowchart-label"><rect height="34" width="207.609375" y="-17" x="-103.8046875" ry="0" rx="0" style="" class="basic label-container"/><g transform="translate(0, -9.5)" style="" class="label"><rect/><text style=""><tspan class="row" x="0" dy="1em" xml:space="preserve">HTTP/TLS/TCP/UDP layers</tspan></text></g></g></g></g></g></svg>